# NixOS 安装指南

## 准备工作（在 ISO 启动后）

### 方法 1：从 GitHub 下载（需要网络）
```bash
# ISO 环境中可能没有 git，使用 curl 下载
curl -L https://github.com/YOUR_USERNAME/nixos-config/archive/main.tar.gz -o config.tar.gz
tar xzf config.tar.gz
cd nixos-config-main  # 或解压后的目录名
```

### 方法 2：从 USB 拷贝（推荐）
```bash
# 1. 在另一台机器上准备配置：
#    - 克隆仓库或下载 zip
#    - 拷贝到 USB

# 2. 在 ISO 环境中：
mkdir -p /tmp/nixos-config
mount /dev/sdX1 /mnt  # X 是 USB 设备号
cp -r /mnt/nixos-config /tmp/
cd /tmp/nixos-config
```

### 方法 3：临时启用 git（如果有网络）
```bash
nix-shell -p git
git clone https://github.com/YOUR_USERNAME/nixos-config.git
cd nixos-config
```

## 运行安装脚本

```bash
sudo bash scripts/auto-install.sh
```

## 环境变量（可选）

```bash
# 预设参数避免交互式输入
export NIXOS_USER="myname"
export NIXOS_HOSTNAME="nixos-config"
export NIXOS_DISK="/dev/nvme0n1"
export NIXOS_GPU="amd"  # 或 nvidia/none
export NIXOS_SWAP_SIZE_GB="32"

sudo -E bash scripts/auto-install.sh
```

## 安装后

```bash
reboot
```

登录后运行：
```bash
cd ~/nixos-config
sudo nixos-rebuild switch --flake .#nixos-config
```
